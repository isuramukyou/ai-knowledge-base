# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Telegram Mini App

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Telegram Mini App**
- ‚úÖ Cookies –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ headers –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ iframe
- ‚úÖ localStorage –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- ‚úÖ initData –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ production
- ‚úÖ –ú–æ–∫-–¥–∞–Ω–Ω—ã–µ –¥–ª—è development —Ä–µ–∂–∏–º–∞

### 2. **–ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å**
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "Admin" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "Admin" –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –∞–¥–º–∏–Ω–∫—É
- ‚úÖ Server-side –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –≤ middleware
- ‚úÖ –ó–∞—â–∏—Ç–∞ –≤—Å–µ—Ö –∞–¥–º–∏–Ω—Å–∫–∏—Ö API endpoints

### 3. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ Telegram WebApp
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ Fallback –Ω–∞ localStorage –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ Development —Ä–µ–∂–∏–º —Å –º–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –í Telegram Mini App (Production):
1. **Telegram –ø–µ—Ä–µ–¥–∞–µ—Ç initData** ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å—å
2. **–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage** ‚Üí –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç cookies
3. **Headers –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º** ‚Üí `x-telegram-id`, `x-auth-token`
4. **API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞** ‚Üí –ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î

### –í Development —Ä–µ–∂–∏–º–µ:
1. **–°–æ–∑–¥–∞–µ—Ç—Å—è –º–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** ‚Üí ID –∏–∑ `NEXT_PUBLIC_DEV_ADMIN_ID`
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** ‚Üí –ö–∞–∫ –Ω–∞—Å—Ç–æ—è—â–∏–π Telegram –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
3. **–ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞** ‚Üí –î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### Production:
```bash
NODE_ENV=production
ADMIN_TELEGRAM_ID=123456789
JWT_SECRET=super-secret-jwt-token
```

### Development:
```bash
NODE_ENV=development
NEXT_PUBLIC_DEV_ADMIN_ID=579218344  # –í–∞—à Telegram ID
ADMIN_TELEGRAM_ID=579218344         # –¢–æ—Ç –∂–µ ID –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
JWT_SECRET=super-secret-jwt-token
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –£—Ä–æ–≤–Ω–∏ –∑–∞—â–∏—Ç—ã:
1. **Middleware** ‚Üí –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ `/admin` –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º
2. **Server Components** ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø–µ—Ä–µ–¥ —Ä–µ–Ω–¥–µ—Ä–æ–º
3. **API Guards** ‚Üí `requireAuth()` –∏ `requireAdmin()` –≤ –∫–∞–∂–¥–æ–º endpoint
4. **JWT Tokens** ‚Üí –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–µ —Ç–æ–∫–µ–Ω—ã

### –í Production:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Telegram initData
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (24 —á–∞—Å–∞)
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
- ‚úÖ httpOnly cookies + headers –¥–ª—è –¥–≤–æ–π–Ω–æ–π –∑–∞—â–∏—Ç—ã

### –í Development:
- ‚úÖ –ú–æ–∫-–¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–º–∏—Ç–∞—Ü–∏—è Telegram WebApp API
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–æ–∫-—Ç–æ–∫–µ–Ω—ã

## üì± –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
- –û—Ç–∫—Ä—ã–≤–∞—é—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –°–æ–∑–¥–∞—é—Ç –∑–∞–ø–∏—Å–∏ ‚Üí –†–∞–±–æ—Ç–∞–µ—Ç —Å –∏—Ö Telegram ID
- –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã:
- –í–∏–¥—è—Ç –±–µ–π–¥–∂ "Admin" –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
- –ö–ª–∏–∫ –ø–æ "Admin" ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üö® –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Console
2. –ù–∞–π–¥–∏—Ç–µ –ª–æ–≥–∏:
   - `"Initializing Telegram WebApp..."`
   - `"Telegram user found:"`
   - `"Auth data stored in localStorage:"`

### –ï—Å–ª–∏ –Ω–µ –≤–∏–¥–Ω–æ –∫–Ω–æ–ø–∫—É Admin:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤–∞—à `telegram_id` = `ADMIN_TELEGRAM_ID`
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –ª–æ–≥–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `user.is_admin = true`

### –í Development:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `NEXT_PUBLIC_DEV_ADMIN_ID` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –ú–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. –ê–¥–º–∏–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ä–∞–∑—É

## üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Checklist –¥–ª—è Production:
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Telegram WebApp
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –∫–Ω–æ–ø–∫—É "Admin"
- [ ] –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–µ –º–æ–≥—É—Ç –∑–∞–π—Ç–∏ –≤ `/admin`
- [ ] API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### Checklist –¥–ª—è Development:
- [ ] –ú–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –ê–¥–º–∏–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞** —Å Telegram Mini App –∏ **–Ω–∞–¥–µ–∂–Ω–æ –∑–∞—â–∏—â–µ–Ω–∞** –≤–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö! üéâ 